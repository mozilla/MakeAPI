(function(e){function t(t){function D(){c=true}function P(){c=false;Dt()}function H(e){v=e}function B(e){g=e}function j(e){e=e||0;var t;for(var n=e,r=s.length;n<r;n++){t=s[n][i];if(t===undefined){throw"Each data element must implement a unique 'id' property"}u[t]=n}}function F(){var e;for(var t=0,n=s.length;t<n;t++){e=s[t][i];if(e===undefined||u[e]!==t){throw"Each data element must implement a unique 'id' property"}}}function I(){return s}function q(e,t){if(t!==undefined){i=t}s=y=e;u={};j();F();Dt()}function R(e){if(e.pageSize!=undefined){k=e.pageSize;L=k?Math.min(L,Math.max(0,Math.ceil(A/k)-1)):0}if(e.pageNum!=undefined){L=Math.min(e.pageNum,Math.max(0,Math.ceil(A/k)-1))}_.notify(U(),null,n);Dt()}function U(){var e=k?Math.max(1,Math.ceil(A/k)):1;return{pageSize:k,pageNum:L,totalRows:A,totalPages:e}}function z(e,t){h=t;d=e;p=null;if(t===false){s.reverse()}s.sort(e);if(t===false){s.reverse()}u={};j();Dt()}function W(e,t){h=t;p=e;d=null;var n=Object.prototype.toString;Object.prototype.toString=typeof e=="function"?e:function(){return this[e]};if(t===false){s.reverse()}s.sort();Object.prototype.toString=n;if(t===false){s.reverse()}u={};j();Dt()}function X(){if(d){z(d,h)}else if(p){W(p,h)}}function V(e){f=e;if(t.inlineFilters){b=Ct();w=kt()}Dt()}function J(){return x}function K(n){if(!t.groupItemMetadataProvider){t.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider}T=[];N=[];n=n||[];x=n instanceof Array?n:[n];for(var r=0;r<x.length;r++){var i=x[r]=e.extend(true,{},S,x[r]);i.getterIsAFn=typeof i.getter==="function";i.compiledAccumulators=[];var s=i.aggregators.length;while(s--){i.compiledAccumulators[s]=Nt(i.aggregators[s])}N[r]={}}Dt()}function Q(e,t,n){if(e==null){K([]);return}K({getter:e,formatter:t,comparer:n})}function G(e,t){if(!x.length){throw new Error("At least one grouping must be specified before calling setAggregators().")}x[0].aggregators=e;x[0].aggregateCollapsed=t;K(x)}function Y(e){return s[e]}function Z(e){return u[e]}function et(){if(!a){a={};for(var e=0,t=o.length;e<t;e++){a[o[e][i]]=e}}}function tt(e){et();return a[e]}function nt(e){return s[u[e]]}function rt(e){var t=[];et();for(var n=0;n<e.length;n++){var r=a[e[n]];if(r!=null){t[t.length]=r}}return t}function it(e){var t=[];for(var n=0;n<e.length;n++){if(e[n]<o.length){t[t.length]=o[e[n]][i]}}return t}function st(e,t){if(u[e]===undefined||e!==t[i]){throw"Invalid or non-matching id"}s[u[e]]=t;if(!l){l={}}l[e]=true;Dt()}function ot(e,t){s.splice(e,0,t);j(e);Dt()}function ut(e){s.push(e);j(s.length-1);Dt()}function at(e){var t=u[e];if(t===undefined){throw"Invalid id"}delete u[e];s.splice(t,1);j(t);Dt()}function ft(){return o.length}function lt(e){return o[e]}function ct(e){var n=o[e];if(n===undefined){return null}if(n.__group){return t.groupItemMetadataProvider.getGroupRowMetadata(n)}if(n.__groupTotals){return t.groupItemMetadataProvider.getTotalsRowMetadata(n)}return null}function ht(e,t){if(e==null){for(var n=0;n<x.length;n++){N[n]={};x[n].collapsed=t}}else{N[e]={};x[e].collapsed=t}Dt()}function pt(e){ht(e,true)}function dt(e){ht(e,false)}function vt(e,t,n){N[e][t]=x[e].collapsed^n;Dt()}function mt(e){var t=Array.prototype.slice.call(arguments);var n=t[0];if(t.length==1&&n.indexOf(C)!=-1){vt(n.split(C).length-1,n,true)}else{vt(t.length-1,t.join(C),true)}}function gt(e){var t=Array.prototype.slice.call(arguments);var n=t[0];if(t.length==1&&n.indexOf(C)!=-1){vt(n.split(C).length-1,n,false)}else{vt(t.length-1,t.join(C),false)}}function yt(){return T}function bt(e,t){var n;var r;var i=[];var s=[];var o;var u=t?t.level+1:0;var a=x[u];for(var f=0,l=a.predefinedValues.length;f<l;f++){r=a.predefinedValues[f];n=s[r];if(!n){n=new Slick.Group;n.value=r;n.level=u;n.groupingKey=(t?t.groupingKey+C:"")+r;i[i.length]=n;s[r]=n}}for(var f=0,l=e.length;f<l;f++){o=e[f];r=a.getterIsAFn?a.getter(o):o[a.getter];n=s[r];if(!n){n=new Slick.Group;n.value=r;n.level=u;n.groupingKey=(t?t.groupingKey+C:"")+r;i[i.length]=n;s[r]=n}n.rows[n.count++]=o}if(u<x.length-1){for(var f=0;f<i.length;f++){n=i[f];n.groups=bt(n.rows,n)}}i.sort(x[u].comparer);return i}function wt(e){var t=x[e.level];var n=e.level==x.length;var r=new Slick.GroupTotals;var i,s=t.aggregators.length;while(s--){i=t.aggregators[s];i.init();t.compiledAccumulators[s].call(i,!n&&t.aggregateChildGroups?e.groups:e.rows);i.storeResult(r)}r.group=e;e.totals=r}function Et(e,t){t=t||0;var n=x[t];var r=e.length,i;while(r--){i=e[r];if(i.collapsed&&!n.aggregateCollapsed){continue}if(i.groups){Et(i.groups,t+1)}if(n.aggregators.length&&(n.aggregateEmpty||i.rows.length||i.groups&&i.groups.length)){wt(i)}}}function St(e,t){t=t||0;var n=x[t];var r=n.collapsed;var i=N[t];var s=e.length,o;while(s--){o=e[s];o.collapsed=r^i[o.groupingKey];o.title=n.formatter?n.formatter(o):o.value;if(o.groups){St(o.groups,t+1);o.rows=[]}}}function xt(e,t){t=t||0;var n=x[t];var r=[],i,s=0,o;for(var u=0,a=e.length;u<a;u++){o=e[u];r[s++]=o;if(!o.collapsed){i=o.groups?xt(o.groups,t+1):o.rows;for(var f=0,l=i.length;f<l;f++){r[s++]=i[f]}}if(o.totals&&n.displayTotalsRow&&(!o.collapsed||n.aggregateCollapsed)){r[s++]=o.totals}}return r}function Tt(e){var t=/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/;var n=e.toString().match(t);return{params:n[1].split(","),body:n[2]}}function Nt(e){var t=Tt(e.accumulate);var n=new Function("_items","for (var "+t.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+t.params[0]+" = _items[_i]; "+t.body+"}");n.displayName=n.name="compiledAccumulatorLoop";return n}function Ct(){var e=Tt(f);var t=e.body.replace(/return false[;}]/gi,"{ continue _coreloop; }").replace(/return true[;}]/gi,"{ _retval[_idx++] = $item$; continue _coreloop; }").replace(/return ([^;}]+?);/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }");var n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,t);n=n.replace(/\$item\$/gi,e.params[0]);n=n.replace(/\$args\$/gi,e.params[1]);var r=new Function("_items,_args",n);r.displayName=r.name="compiledFilter";return r}function kt(){var e=Tt(f);var t=e.body.replace(/return false[;}]/gi,"{ continue _coreloop; }").replace(/return true[;}]/gi,"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }").replace(/return ([^;}]+?);/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }");var n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,t);n=n.replace(/\$item\$/gi,e.params[0]);n=n.replace(/\$args\$/gi,e.params[1]);var r=new Function("_items,_args,_cache",n);r.displayName=r.name="compiledFilterWithCaching";return r}function Lt(e,t){var n=[],r=0;for(var i=0,s=e.length;i<s;i++){if(f(e[i],t)){n[r++]=e[i]}}return n}function At(e,t,n){var r=[],i=0,s;for(var o=0,u=e.length;o<u;o++){s=e[o];if(n[o]){r[i++]=s}else if(f(s,t)){r[i++]=s;n[o]=true}}return r}function Ot(e){if(f){var n=t.inlineFilters?b:Lt;var r=t.inlineFilters?w:At;if(v.isFilterNarrowing){y=n(y,g)}else if(v.isFilterExpanding){y=r(e,g,E)}else if(!v.isFilterUnchanged){y=n(e,g)}}else{y=k?e:e.concat()}var i;if(k){if(y.length<L*k){L=Math.floor(y.length/k)}i=y.slice(k*L,k*L+k)}else{i=y}return{totalRows:y.length,rows:i}}function Mt(e,t){var n,r,s,o=[];var u=0,a=t.length;if(v&&v.ignoreDiffsBefore){u=Math.max(0,Math.min(t.length,v.ignoreDiffsBefore))}if(v&&v.ignoreDiffsAfter){a=Math.min(t.length,Math.max(0,v.ignoreDiffsAfter))}for(var f=u,c=e.length;f<a;f++){if(f>=c){o[o.length]=f}else{n=t[f];r=e[f];if(x.length&&(s=n.__nonDataRow||r.__nonDataRow)&&n.__group!==r.__group||n.__group&&!n.equals(r)||s&&(n.__groupTotals||r.__groupTotals)||n[i]!=r[i]||l&&l[n[i]]){o[o.length]=f}}}return o}function _t(e){a=null;if(v.isFilterNarrowing!=m.isFilterNarrowing||v.isFilterExpanding!=m.isFilterExpanding){E=[]}var t=Ot(e);A=t.totalRows;var n=t.rows;T=[];if(x.length){T=bt(n);if(T.length){Et(T);St(T);n=xt(T)}}var r=Mt(o,n);o=n;return r}function Dt(){if(c){return}var e=o.length;var t=A;var r=_t(s,f);if(k&&A<L*k){L=Math.max(0,Math.ceil(A/k)-1);r=_t(s,f)}l=null;m=v;v={};if(t!=A){_.notify(U(),null,n)}if(e!=o.length){O.notify({previous:e,current:o.length},null,n)}if(r.length>0){M.notify({rows:r},null,n)}}function Pt(e,t){function s(){if(r.length>0){i=true;var s=n.mapIdsToRows(r);if(!t){r=n.mapRowsToIds(s)}e.setSelectedRows(s);i=false}}var n=this;var r=n.mapRowsToIds(e.getSelectedRows());var i;e.onSelectedRowsChanged.subscribe(function(t,s){if(i){return}r=n.mapRowsToIds(e.getSelectedRows())});this.onRowsChanged.subscribe(s);this.onRowCountChanged.subscribe(s)}function Ht(e,t){function s(e){n={};for(var t in e){var r=o[t][i];n[r]=e[t]}}function u(){if(n){r=true;et();var i={};for(var s in n){var o=a[s];if(o!=undefined){i[o]=n[s]}}e.setCellCssStyles(t,i);r=false}}var n;var r;s(e.getCellCssStyles(t));e.onCellCssStylesChanged.subscribe(function(e,n){if(r){return}if(t!=n.key){return}if(n.hash){s(n.hash)}});this.onRowsChanged.subscribe(u);this.onRowCountChanged.subscribe(u)}var n=this;var r={groupItemMetadataProvider:null,inlineFilters:false};var i="id";var s=[];var o=[];var u={};var a=null;var f=null;var l=null;var c=false;var h=true;var p;var d;var v={};var m={};var g;var y=[];var b;var w;var E=[];var S={getter:null,formatter:null,comparer:function(e,t){return e.value-t.value},predefinedValues:[],aggregators:[],aggregateEmpty:false,aggregateCollapsed:false,aggregateChildGroups:false,collapsed:false,displayTotalsRow:true};var x=[];var T=[];var N=[];var C=":|:";var k=0;var L=0;var A=0;var O=new Slick.Event;var M=new Slick.Event;var _=new Slick.Event;t=e.extend(true,{},r,t);return{beginUpdate:D,endUpdate:P,setPagingOptions:R,getPagingInfo:U,getItems:I,setItems:q,setFilter:V,sort:z,fastSort:W,reSort:X,setGrouping:K,getGrouping:J,groupBy:Q,setAggregators:G,collapseAllGroups:pt,expandAllGroups:dt,collapseGroup:mt,expandGroup:gt,getGroups:yt,getIdxById:Z,getRowById:tt,getItemById:nt,getItemByIdx:Y,mapRowsToIds:it,mapIdsToRows:rt,setRefreshHints:H,setFilterArgs:B,refresh:Dt,updateItem:st,insertItem:ot,addItem:ut,deleteItem:at,syncGridSelection:Pt,syncGridCellCssStyles:Ht,getLength:ft,getItem:lt,getItemMetadata:ct,onRowCountChanged:O,onRowsChanged:M,onPagingInfoChanged:_}}function n(e){this.field_=e;this.init=function(){this.count_=0;this.nonNullCount_=0;this.sum_=0};this.accumulate=function(e){var t=e[this.field_];this.count_++;if(t!=null&&t!==""&&t!==NaN){this.nonNullCount_++;this.sum_+=parseFloat(t)}};this.storeResult=function(e){if(!e.avg){e.avg={}}if(this.nonNullCount_!=0){e.avg[this.field_]=this.sum_/this.nonNullCount_}}}function r(e){this.field_=e;this.init=function(){this.min_=null};this.accumulate=function(e){var t=e[this.field_];if(t!=null&&t!==""&&t!==NaN){if(this.min_==null||t<this.min_){this.min_=t}}};this.storeResult=function(e){if(!e.min){e.min={}}e.min[this.field_]=this.min_}}function i(e){this.field_=e;this.init=function(){this.max_=null};this.accumulate=function(e){var t=e[this.field_];if(t!=null&&t!==""&&t!==NaN){if(this.max_==null||t>this.max_){this.max_=t}}};this.storeResult=function(e){if(!e.max){e.max={}}e.max[this.field_]=this.max_}}function s(e){this.field_=e;this.init=function(){this.sum_=null};this.accumulate=function(e){var t=e[this.field_];if(t!=null&&t!==""&&t!==NaN){this.sum_+=parseFloat(t)}};this.storeResult=function(e){if(!e.sum){e.sum={}}e.sum[this.field_]=this.sum_}}e.extend(true,window,{Slick:{Data:{DataView:t,Aggregators:{Avg:n,Min:r,Max:i,Sum:s}}}})})(jQuery)
